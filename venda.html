<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realizar Venda</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <!-- Adicione o link para a biblioteca Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        header {
            background-color: #343a40;
            color: #ffffff;
            padding: 20px 0;
            text-align: center;
        }
        .btn-home {
            background-color: #007bff;
            color: #ffffff;
            border: none;
            margin-left: 15px;
        }
        h1{
            margin: auto;
            margin-left: -1vh;
        }
    </style>
</head>
<body>
    <!-- Cabeçalho da página -->
    <header class="d-flex justify-content-between align-items-center">
        <!-- Botão de ir para index.html com ícone de casa -->
        <a href="index.html" class="btn btn-home mr-auto"><i class="fas fa-home"></i></a>
        <h1>Vendas</h1>
    </header>
    <div class="container">
        <h1 class="mt-5 mb-4">Realizar Venda</h1>
        <form id="formVenda">
            <div class="form-group">
                <label for="produto">Nome do Produto:</label>
                <select class="form-control" id="produto" required>
                    <!-- Opções de produtos carregadas dinamicamente -->
                    <option value="Selecione o Nome">Selecione o Tamanho</option>
                    <option value="Mochila Infantil" data-tipo="Costa" data-tamanho="P" data-divisoria="1" data-valor="50.00">Mochila Infantil</option>
                    <option value="Mochila Juvenil" data-tipo="Carrinho" data-tamanho="M" data-divisoria="2" data-valor="60.00">Mochila Juvenil</option>
                    <option value="Mochila Company" data-tipo="Furada" data-tamanho="G" data-divisoria="3" data-valor="70.00">Mochila Company</option>
                    <option value="Lancheira" data-tipo="Outro" data-tamanho="Outro" data-divisoria="4" data-valor="40.00">Lancheira</option>
                    <option value="Porta lápis" data-tipo="Outro" data-tamanho="Outro" data-divisoria="5" data-valor="20.00">Porta lápis</option>
                </select>
            </div>
            <div class="form-group">
                <label for="tipo">Tipo:</label>
                <select class="form-control" id="tipo" readonly>
                    <option value="Selecione o Tipo">Selecione  o Tipo</option>
                    <option value="Costa">Costa</option>
                    <option value="Carrinho">Carrinho</option>
                    <option value="Furada">Furada</option>
                    <option value="Outro">Outro</option>
                </select>
            </div>
            <div class="form-group">
                <label for="tamanho">Tamanho:</label>
                <select class="form-control" id="tamanho" readonly>
                    <option value="Selecione o Tamanho">Selecione o Tamanho</option>
                    <option value="P">P</option>
                    <option value="M">M</option>
                    <option value="G">G</option>
                    <option value="Outro">Outro</option>
                </select>
            </div>
            <div class="form-group">
                <label for="reparticoes">Repartições</label>
                <!-- Dropdown para selecionar o número de repartições -->
                <select class="form-control" id="reparticoes" required>
                    <option value="">Selecione as repartições</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="Outro">Outro</option>
                </select>
            </div>
            <div class="form-group">
                <label for="personagem">Personagem:</label>
                <select class="form-control" id="personagem" readonly>
                    <!-- Opções de personagens carregadas dinamicamente -->
                </select>
            </div>
            <div class="form-group">
                <label for="quantidade">Quantidade:</label>
                <input type="number" class="form-control" id="quantidade" min="1" required>
            </div>
            <div class="form-group">
                <label for="valor">Valor (R$):</label>
                <input type="text" class="form-control" id="valor" readonly>
            </div>
            <div class="form-group">
                <label for="desconto">Desconto (R$):</label>
                <input type="number" class="form-control" id="desconto" min="0">
            </div>
            <div class="form-group">
                <label for="total">Total (R$):</label>
                <input type="text" class="form-control" id="total" readonly>
            </div>
            <button type="submit" class="btn btn-primary">Realizar Venda</button>
        </form>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        $(document).ready(function() {
            // Atualizar campos de informações do produto ao selecionar
            $('#produto').change(function() {
                let option = $(this).find('option:selected');
                $('#tipo').val(option.data('tipo'));
                $('#tamanho').val(option.data('tamanho'));
                $('#valor').val(option.data('valor'));
                calcularTotal();
            });

            // Carregar opções de personagens no select
            let personagens = JSON.parse(localStorage.getItem('personagens')) || [];
            let selectPersonagem = $('#personagem');
            personagens.forEach(function(personagem) {
                selectPersonagem.append(`<option value="${personagem}">${personagem}</option>`);
            });

            // Calcular o total ao alterar a quantidade ou o desconto
            $('#quantidade, #desconto').change(function() {
                calcularTotal();
            });

            // Evento de envio do formulário de venda
            $('#formVenda').submit(function(event) {
                event.preventDefault();
                // Simulando uma venda com alertas
                alert('Venda realizada com sucesso!');
                // Você precisará modificar isso para que funcione corretamente com a sua aplicação

                // Após realizar a venda, limpe o formulário
                $('#quantidade, #desconto').val('');
                $('#produto').val($('#produto option:first').val()).change(); // Retorna ao primeiro produto
            });

            // Função para calcular o total da venda
            function calcularTotal() {
                let quantidade = parseInt($('#quantidade').val()) || 0;
                let valor = parseFloat($('#valor').val()) || 0;
                let desconto = parseFloat($('#desconto').val()) || 0;
                let total = (quantidade * valor) - desconto;
                $('#total').val(total.toFixed(2));
            }

            // Simular a seleção do primeiro produto ao carregar a página
            $('#produto').change();
        });
    </script>
</body>
</html>
